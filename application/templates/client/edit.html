{% extends 'base.html' %}

{% block title %} {{ title_page }} {% endblock %}

{% block title_header %} {{ title_page }} {% endblock %}


{% block  button %}
    <a class="uk-button waves-effect waves-effect uk-button-success uk-button-small" id="submit" href=""><span class="uk-margin-small-right"><i class="fa fa-floppy-o"></i></span>Enreg.</a>
    {% if client_id %}
    <a class="uk-button waves-effect uk-button-danger uk-button-small" href="{{ url_for('client.view', client_id=client_id, paged=request.args.get('paged'), news=request.args.get('news')) }}"><span class="uk-margin-small-right"><i class="fa fa-times"></i></span>Annuler</a>
    {% else %}
    <a class="uk-button waves-effect uk-button-danger uk-button-small" href="{{ url_for('client.index', paged=request.args.get('paged'), news=news) }}"><span class="uk-margin-small-right"><i class="fa fa-times"></i></span>Annuler</a>
    {% endif %}
{% endblock %}

{% block layout_content %}
<div class="uk-container uk-margin">
            {% include 'includes/flash_message.html' %}
            <div class="uk-grid-small" uk-grid>
                <div class="uk-width-1-1">
                    <form method="post" id="formulaire">
                        <div class="uk-card uk-card-default uk-card-small uk-card-body">
                            {% if client_id %}
                                <div class="uk-position-top-right uk-padding-small uk-width-1-3@s uk-flex uk-flex-right">
                                    <a href="{{ url_for('client.etat', client_id=client_id, news=request.args.get('news')) }}" class="uk-button waves-effect uk-actives {% if data.activated %} uk-button-success-active {% else %} uk-button-danger-active {% endif %} uk-button-small">
                                        <span>{% if data.activated %} Activé {% else %} Desactivé {% endif %}</span>
                                    </a>
                                </div>
                            {% endif %}

                            {{ form.hidden_tag() }}
                            <div class="uk-padding uk-padding-remove-horizontal uk-grid-small" uk-grid>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.raison.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            <select name="raison" id="" class="uk-select selected ">
                                                <option value="">Selectionnez</option>
                                                <option value="LT" {% if form.raison.data == 'LT' %} selected {% endif %}>Etablissement</option>
                                                <option value="SARL" {% if form.raison.data == 'SARL' %} selected {% endif %}>SARL (Société à responsabilité limitée)</option>
                                                <option value="SA" {% if form.raison.data == 'SA' %} selected {% endif %}>SA (Société Anonyme)</option>
                                            </select>
                                            {% for message in form.raison.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.name.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.name(class_='uk-input required') }}
                                            {% for message in form.name.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.idcategorie.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.idcategorie(class_='uk-select selected required') }}
                                            {% for message in form.idcategorie.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.maincategorie.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.maincategorie(class_='uk-select selected required') }}
                                            {% for message in form.maincategorie.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.email.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.email(class_='uk-input required') }}
                                            {% for message in form.email.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.phone.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.phone(class_='uk-input') }}
                                            {% for message in form.phone.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.region.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.region(class_='uk-input required') }}
                                            {% for message in form.region.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.ville.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.ville(class_='uk-input required') }}
                                            {% for message in form.ville.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.quartier.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.quartier(class_='uk-input  required') }}
                                            {% for message in form.quartier.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.repere.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.repere(class_='uk-input') }}
                                            {% for message in form.repere.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.postal_code.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.postal_code(class_='uk-input') }}
                                            {% for message in form.postal_code.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.adresse.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.adresse(class_='uk-input') }}
                                            {% for message in form.adresse.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.urlsite.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.urlsite(class_='uk-input') }}
                                            {% for message in form.urlsite.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.facebook.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.facebook(class_='uk-input') }}
                                            {% for message in form.facebook.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.twitter.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.twitter(class_='uk-input') }}
                                            {% for message in form.twitter.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.linkedin.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.linkedin(class_='uk-input') }}
                                            {% for message in form.linkedin.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.youtube.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.youtube(class_='uk-input') }}
                                            {% for message in form.youtube.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <div class="uk-width-1-1@s">
                                    <div class="uk-margin">
                                        {{ form.description.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.description(class_='uk-textarea') }}
                                            {% for message in form.description.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.latitude.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.latitude(class_='uk-input') }}
                                            {% for message in form.latitude.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-width-1-2@s">
                                    <div class="uk-margin">
                                        {{ form.longitude.label(class_='uk-form-label uk-text-bold') }}
                                        <div class="uk-form-controls">
                                            {{ form.longitude(class_='uk-input') }}
                                            {% for message in form.longitude.errors %}
                                                <div class="uk-alert uk-alert-danger">{{ message }}</div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </form>
                </div>

            </div>
    </div>


{% endblock %}

{% block footer_script %}

     <script>
        $('#submit').on('click', function(e){
            e.preventDefault();
            $('#formulaire').submit();
        });


        $('#idcategorie').on('change', function(e) {
            e.preventDefault();

            var idcategorie = $(this).val();
            var datas = {};
            datas['data'] = idcategorie;

            var url = '{{ url_for('client.reload_categorie') }}';
            $.ajax({
                url: url,
                type: 'POST',
                data: JSON.stringify(datas),
                contentType: 'application/json;charset=UTF-8',
                dataType: "json",
                success: function (data) {
                    if(data['statut'] == 'OK'){
                        var count = 0;
                        $('#maincategorie option:gt(0)').remove();

                        $.each(data['data'], function(index, value) {
                            count++;
                            $("#maincategorie").append('<option value="'+ value['id'] +'">'+ value['name']+'</option>');
                        });
                    }
                }
            });

        });
    </script>

{% endblock %}